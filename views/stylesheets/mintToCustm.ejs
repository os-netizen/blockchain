<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Try</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <!-- <script src="../javascripts/minterButton.js"></script> -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Raleway"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://unpkg.com/moralis/dist/moralis.js"></script>
    <style>
      body,
      html {
        height: 100vh;
      }

      * {
        box-sizing: border-box;
      }

      .bg-img {
        /* The image used */
        background-image: url("https://images.unsplash.com/photo-1639152201720-5e536d254d81?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1032&q=80");
        height: 100vh;
        background-attachment: fixed;
        /* Control the height of the image */
        min-height: 380px;
        height: 100%;
        /* Center and scale the image nicely */
        background-position: center;
        background-repeat: no-repeat;
        background-size: cover;
        position: relative;
      }

      input[type="text"]:focus,
      input[type="password"]:focus {
        background-color: #ddd;
        outline: none;
      }

      .center {
        /* margin-top: 20px; */
        margin: auto;
        width: 50rem;
        padding: 10px;
        /* opacity: 0.8; */
      }

      .btn-center {
        margin: auto;
        width: 5rem;
        padding: 10px;
      }

      .btn:hover {
        opacity: 1;
      }

      .form {
        background-color: #205375;
      }

      .w3-bar .w3-button {
        padding: 16px;
        /* margin-bottom: 20px; */
      }
    </style>
  </head>
  <body class="bg-img">
    <div class="w3-top w3-margin-bottom">
      <div class="w3-bar w3-white w3-card" id="myNavbar">
        <a href="/" class="w3-bar-item w3-button w3-wide">LOGO</a>
        <!-- Right-sided navbar links -->
        <div class="w3-right w3-hide-small">
          <!-- <a href="#about" class="w3-bar-item w3-button">ABOUT</a> -->
          <!-- <!-- <a href="#team" class="w3-bar-item w3-button"
            ><i class="fa fa-user"></i> TEAM</a
          > -->
          <!-- <a href="#work" class="w3-bar-item w3-button"
            ><i class="fa fa-th"></i> WORK</a
          >
          <a href="#pricing" class="w3-bar-item w3-button"
            ><i class="fa fa-usd"></i> PRICING</a
          > -->
          <!-- <a href="/newProducts" class="w3-bar-item w3-button">GENRATE QRs</a> -->
        </div>
        <!-- Hide right-floated links on small screens and replace them with a menu icon -->

        <a
          href="javascript:void(0)"
          class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium"
          onclick="w3_open()"
        >
          <i class="fa fa-bars"></i>
        </a>
      </div>
    </div>

    <!-- <div
      class="center container d-flex justify-content-center align-items-center mt-5 mb-5"
    > -->
    <div
      class="center row mt-5 d-flex align-items-center"
      style="padding-top: 60px"
    >
      <div class="col-md-4 offset-md-6 col-xl-10 offset-xl-1">
        <div class="card shadow">
          <img
            src="https://images.unsplash.com/photo-1642104704074-907c0698cbd9?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTB8fGV0aGVyZXVtfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=600&q=60"
            alt=""
            class="card-img-top"
          />
          <div class="card-body">
            <h5 class="card-title mb-3 text-center">NFT Mint Form</h5>
            <div class="d-flex justify-content-center mb-3 mt-3">
              <button
                class="w3-button w3-deep-orange w3-padding-large"
                onclick="login()"
              >
                Login metamask
              </button>
            </div>
            <form
              action="/newProducts"
              method="POST"
              class="needs-validation"
              novalidate
            >
              <div class="mb-3">
                <label class="form-label" for="companyName">Company Name</label>
                <input
                  class="form-control"
                  type="text"
                  id="companyName"
                  name="companyName"
                  required
                  autofocus
                />
                <div class="valid-feedback">Looks good!</div>
              </div>
              <div class="mb-3">
                <label class="form-label" for="NFTprojectName"
                  >Name of the NFT Series</label
                >
                <input
                  class="form-control"
                  type="text"
                  id="NFTprojectName"
                  name="NFTprojectName"
                  required
                />
                <div class="valid-feedback">Looks good!</div>
              </div>
              <div class="mb-3">
                <label class="form-label" for="NFTtokenName"
                  >Name of NFT token</label
                >
                <input
                  class="form-control"
                  type="text"
                  id="NFTtokenName"
                  name="NFTtokenName"
                  required
                />
                <div class="valid-feedback">Looks good!</div>
              </div>
              <div class="mb-3">
                <label class="form-label" for="noOfNFT"
                  >Number of NFTs to be minted</label
                >
                <input
                  class="form-control"
                  type="number"
                  id="noOfNFT"
                  name="noOfNFT"
                  required
                />
                <div class="valid-feedback">Looks good!</div>
              </div>

              <div class="mb-3">
                <label class="form-label" for="address"
                  >Your ETH-rinkeby address to recieve NFTs on</label
                >
                <input
                  class="form-control"
                  type="text"
                  id="address"
                  name="address"
                  required
                />
              <div class="valid-feedback">Looks good!</div>
              <div class="mb-3 mt-3">
                <label for="formFile" class="form-label"
                  >Upload the image of NFT you want</label
                >
                <input
                  class="form-control"
                  type="file"
                  id="formFile"
                  name="formFile"
                />
              </div>
              <div class="d-flex justify-content-center mb-3 mt-3">
                <button
                  class="w3-button w3-black w3-padding-large"
                  onclick="gogogo()"
                >
                  MINT
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- </div> -->

    <script>
      const serverUrl = "https://jrhct3nepajw.usemoralis.com:2053/server";
      const appId = "GzSUUx4WrVeCG5BEomiP0KdHc1aGhQmVDw5iElq7";
      Moralis.start({ serverUrl, appId });

      //login function
      login = async () => {
        Moralis.authenticate().then(function (user) {
          console.log(user.get("ethAddress"));
        });
      };

      //upload an image
      uploadImage = async () => {
        const data = formFile.files[0];
        const file = new Moralis.File(data.name, data);
        await file.saveIPFS();

        console.log(file.ipfs(), file.hash());

        return file.ipfs();
      };

      //upload the metadata object

      uploadMetaData = async (imageURL) => {
        const object = {
          companyName: document.getElementById("companyName").value,
          "NFT series name": document.getElementById("NFTprojectName").value,
          noOfNft: document.getElementById("noOfNFT").value,
          image: imageURL,
        };
        const file = new Moralis.File("file.json", {
          base64: btoa(JSON.stringify(object)),
        });
        await file.saveIPFS();
        console.log(file.ipfs(), file.hash());
        return file.ipfs();
      };

      //function to goooo
      let ipfsMetaData;
      gogogo = async () => {
        const image = await uploadImage();
        ipfsMetaData = await uploadMetaData(image);
        return ipfsMetaData;
      };
    </script>

    <script>
      // Example starter JavaScript for disabling form submissions if there are invalid fields
      (function () {
        "use strict";

        // Fetch all the forms we want to apply custom Bootstrap validation styles to
        var forms = document.querySelectorAll(".needs-validation");

        // Loop over them and prevent submission
        Array.prototype.slice.call(forms).forEach(function (form) {
          form.addEventListener(
            "submit",
            function (event) {
              if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
              }

              form.classList.add("was-validated");
            },
            false
          );
        });
      })();
    </script>
    <script>
      // Modal Image Gallery
      function onClick(element) {
        document.getElementById("img01").src = element.src;
        document.getElementById("modal01").style.display = "block";
        var captionText = document.getElementById("caption");
        captionText.innerHTML = element.alt;
      }

      // Toggle between showing and hiding the sidebar when clicking the menu icon
      var mySidebar = document.getElementById("mySidebar");

      function w3_open() {
        if (mySidebar.style.display === "block") {
          mySidebar.style.display = "none";
        } else {
          mySidebar.style.display = "block";
        }
      }

      // Close the sidebar with the close button
      function w3_close() {
        mySidebar.style.display = "none";
      }
    </script>
  </body>
</html>
